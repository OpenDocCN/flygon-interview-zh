# 系列 4：P11：【JVM调优实战】JVM调优实战入门 - 马士兵北京中心 - BV1VP411i7E4

好，看这里我们先介绍这这哥们儿，这哥们儿是一个呃比较奇葩的啊，这哥们儿叫epilent，这哥们儿叫做什么都不干垃圾回收器。😊，就什么都不干。空的。这是DDK111才有的。哎，有同学可能就会说了。

老师这这这破玩意儿有啥用啊？😊，他就做个记录，他什么都不干，他就你你你们你你们哥仨啊在这做啥，他都不管，他就他也不他也不清扫，他就拿个摄像机给你们记录下来就行了，好吧。😊，搞这东西有什么用呢？

这东西主要是用来开发JVM的人做第bu个用的。记得到了吗？就是那个我开发的过程，我这垃圾回收器写的怎么样啊？我这垃圾回收过程到底什么样的呀？我用AP跟踪一下。😊，这是第一种用途。第二种用途是啥呢？

第二种用途是。假如我的内存超级大个，我也明确知道我这个程序运行完根本用不了这么多内存。那我干脆就用这种垃圾回收器，你什么都不要给我干。什么时候这程序运行完了，直接结束，整个内存消失就行了。效率极高。

我这个运行过程之中没有任何垃圾回收器在这给我捣乱。Very good。G万这些现在用吗？废话，G万现在都快成主流了，你早就落伍落伍了。你跟着我学永远不会落伍。因为你们你们不抬头看世界，知道吗？嗯。

好ly。CLD成员CLD成务员还等啥呢？千万不要等着后悔啊，几十年后想起来，我本来能够这么走的，就是因为我一犹豫，没有跟着20多位一线大厂的老师带着我飞。还是采用的这样的一个路线，甚至这样惨了。

你来就是了啊，这没有坑。老师呢叫做马士兵是吧？这个机构叫马士兵教也好，直接把我个人名誉啊，什么全堵上去。放心啊，这没坑，你在别地儿呢，就算踩过坑，这儿真没有。你要肯来，就一定能带你飞起来。

20位大厂的一线一线大厂的老师，你就投这偷猪，我也能带你飞起来。我告诉你。啊。好了，不废话了啊。哦，对。秒杀。12点啊，感兴趣抓紧。所以FP了就干这始了，能get到了吗？我们可以继续吗？

你聊D one吧，好不好？😊，G one怎么好玩呢？这晚的好玩点在哪里呢？G1。G one，welcome G one来，我们欢迎G one登场。好，这是G one的核心图。

你会发现G one终于摒弃了分带模型。年轻代、老年代，young old。为啥呢？因为随着内存越来越大，你就算怎么采用并发玩一遍，这个速度也都玩不转啊。年轻的你扫完一次，你总要把整体年轻的扫完吧。

谁的年轻蛋越来越大，我告诉你一次。呃，这种消费的时间，SCW时间依然是非常非常的长，还是不行。另外呢，由于CMS固有的bug，你必须得改进，因此终于诞生了G one的叫做分区算法，叫region。

分区算法叫部分回收，这是它的核心。部分回收是几个意思呢？部分回收的意思就是。我把它分成一个一个小区域。在每个小区里头呢。我只回收其中的几个。你比方说这几个区域快满了。好，我先把这几个回收掉。

这几个区域快满了，我先把这几个区域回收掉。这样的话一边清理区域，一边呢别的这些空的呢再被占用。这样理想的情况是。我永远有空的可用。这叫做G one。需要连续内存放到humanous里面。

humanous就是这个连续的区域连到一起。如果连不上了。开始整理。如果连不上了，开始整理。这就是G one的负利Z。请大家记这个图，这是G one的核心。当然G one呢也有他自己的毛病和bug。

G one的毛病和bug啊，bug没有，主要是毛病。G one的毛病在于哪里呢？G one的毛病其实在于他的一次回收要把年轻贷全都回收完。survivor区伊甸区，他一次回收，要把年轻代年轻代的算法。

YDC全回收完。当你的年轻代越来越大的时候，很大的时候，一次YDC。产生的SW时间也非常长。因此，诞生了ZDC。CDC叫做分页算法。Sa say here。CDC叫分页算分。

而且它的region非常的灵活。这个ZDC我告诉你，这就是g浪的核心。go浪的回收算法就这个算法。ZDC叫0 D Z。zero pauseDC恰号称零停顿。当然他自己的时间呃测算呢据说是一个毫秒啊，1。

68毫秒。有一个网站专门进行过基准测试，2015年测的128G的对内存单次GC停顿最大1。68，平均1。09。那么ZDC的核心在于什么地方呢？

CDC的核心算法叫做颜色指针叫做colored pointer，加上读屏照，叫load barrier。当然它有它这个这个这个同样的也是跟那个呃G万一样，分成一个一个小的区域。

这个小区域呢和呃G万不太一样的是，它这个小区域非常灵活，你可以有一兆的两兆的4兆的、8兆的都可以。与此同时。他不再分代了，不再分年轻代，不再分老年代。不再分老年代啊，不再分cyY吧，不不分这玩意儿了。

他所有权是一样的。它每100个毫秒默认的情况下就会触发一次GC。而这个DC总是找到那些特别满的那些个区域，把他们拎出来，给它回收掉。没有年轻的，没有老年代，越来越简单。this is ZDC的核心。

当然我现在还不能给你解释颜色指针，因为它太复杂了。短时间内很难给你解释清楚。G万每个区域是几兆固定的嘛？11到32之间，你选一个二的倍数，12481632，就这几个不能选别的。ok。好。

我说我说清楚了吗？这样不会产生内存碎片吗？为什么会产生？这样它的碎片不就产生这个区域内部吗？你想想看。就在这个区域内吧，它是复制算法，这个区域活着的，复制到这里来，整个区域回收掉好。就是这里思的核心。

那有同学会说，老师闲念的又是个什么鬼呢？德是daK12才引入的新的垃圾回收器。这个垃圾回收器是谁贡献给？呃，开元开开源开源界的open JDK的呢。这是red hat，著名的红帽。

开发了一个这个ZDC和谢，他们两个的算法叫类似。很类似。这里头只有一个平整，里头是三个平整。其他的都一样，都是这种分分页的O。这两个是一个竞争关系。

CDC是oracle官方支持sha德是开源领域贡献出来的。将来用哪个，目前这哥俩还在竞争之中，到目前为止，sha德的成熟度要比ZDC高。但是ZDC毕竟官方支持，也许将来的发展应该是ZDC为王。

Maybe啊。GY不GY不是不分带吗？我看图上有同学仔细听，作为G one来说，跟面试官聊最精确的疗法叫做物理上不分带。叫物理。不分带。逻辑。粉带。我能这句话听清楚了吗？十文件的。就这块区域啊。

在逻辑上它会属于年轻代或者老年代或者伊恋区呃，或者sviver区，它会属于这玩意儿。但是在物理上呢，它是一个一个的小区域。Yeah。Yeah。Okay。呃，你比如你比如说啊像。

这个GY内存并不是固定的一点区或者old的区。它在这个时刻，它可能是属于old的区。但是当它回收完了之后，下一次再分配的时候。他完全也可以把它当成什么呢？可以当成一点区，注意看这里它最开始是一甸区。

对吧？我们把它回收掉。回收掉之后，下一次开始分配的时候，它可能把它当成O的区了。😊，同样的物理上一块区域。这般用了这万之后，可以理解为东堆空间就不行。大哥，我刚才不是说这问题了吗？蓝风。

我这费劲巴拉跟你说什么呢？😡，逻辑上分担，物理上不分担，还不清楚。你晚我想一想你这晚得理赛嘛，去VIP听吧。另晚我给大家讲实战好不好？我还没有讲实战呢。还没讲实战呢，实战比这个更好玩。

你是你你你得在简历上写有实战经验呀，是不是啊？白皮1克。呃，问问一下咱们小姐姐OK。😊，好，aly，11点半了，咱们今儿就到这儿吧，好不好？明天见喽。See you tomorrow。

