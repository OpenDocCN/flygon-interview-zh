# 系列 4：P2：【JVM调优实战】C、C++的发展史 - 马士兵北京中心 - BV1VP411i7E4

呃，所以所有的程序啊最难调试的bug基本上就这两个，这是最难调试，一个叫野指针一个叫并发问题。可以这么说，在最开始的语言的发展的历史上，都是沿着对这种bug来来来更加容易调试的这个方向不断发展。

像原来C和CR加的话，大家应该知道这种是什么是是怎么怎么管理这块内存啊，怎么管理这个指针的呀，叫手工吧，手工管理。不知道有多少同学是学过C或者是CI加的。有没有有的话，老师扣个一来。

CBI里面分怎么分配一波内存？memory allocation对吧？当然它有好多好多函数都可以分配啊。这其中一个memory allocation的意思我就是开始哎在我们的内存空间里面找了块内存。

但是你总得释放它呀，你怎么释放？😊，free这个函数就可以把它给释放了。但是我告诉你啊，也许因为程序里面充满了各种各样的分支循环啊，各种各样的不同的岔路，它并不是说只有一条路线，所以只有一条路线。

或就简单了。我这边分呃mem allocation完了之后呢，后面马上就把它fr掉。可是在很多种情况下，我是要需要判断的。在这种情况下，我要把它删掉。在另外一种情况下，我不要把它删掉。我告诉你。

这就造成了各种各样各种各样麻烦的bug。所以手工管理内存，无论是C里面的memory allocation。或者是CI加里面的new和delete。本质上他这这这哥俩是一回事儿。这两段是一回事儿。

都是需要你进行手工管理。手工管理最麻烦的事情就是你不小心忘了删了，你知道吧？这空间你分配好了，但是你不小心给忘了，你把它给忘忘在这儿了，这时候会会承认什么？告诉我一下。忘记删除。忘记释放。这个呢叫。

Memory leak。这叫内存泄露，不要不要叫内存移出。大哥，它没有移出，它只是泄露了。泄露什么概念？泄露的意思就是这块空间呢虽然说留在这里，但是所有任何其他的程序不能去访问它了。不能使用它。

他留在这儿，他没用了，但是别人也不能用，这就叫泄露了。如果泄漏越来越多，会发生什么？泄露的越来越多。泄露越来越多会发生一种现象，就是当新的内存空间要申请的时候来了，我我需要申请这么大一块。

我突然间发现这里面充满了一个一个洞一个一个洞，而且中间我找不到一块连续的内存。来为我这块内存分配空间了，完蛋。这个叫内存溢出。泄露过多的时候容易产生内存溢出，但它本身不叫内存溢出。

All to memory。当然这种呢还算是不是不是很严重啊，大不了我重启一下是吧？你又能跑好长好长时间。所以调优JVM调优最重要的一点叫做重启。每两周重启一次。玩过游戏吗？有的游戏是不是就这样？

各位指挥官，我们的游戏服务器将在5分钟之后启动进行维护，在此期间不得互相攻击。good，你们已经学会了第一种。调优的。常用的方式。当然你不能跟面试官这么说，左右调优嘛。

做过怎么做到重启面试官一个大嘴巴子给你抽上来，哪凉快哪待着去。这是第一种有可能会产生问题的地方，叫忘记是吧？第二种是什么？第二种叫做。释放多次。就是你释放了一次，你delete了它的一次。

由于有分支判断各种各种方面的情况存在，也许有可能你free了好多次，delete了好多次。这个有同学说没问题啊，这块空间我不是干掉他一次，没关系啊，我再干他一次吗？不就是尸体让我又干了他一次吗？

编尸而已。没错，你只是编了个诗的，问题倒是不是特别大。但关键是当你干见他第一次的时候，有另外一个人已经把这块空间给重用了。人家已经又放上有用的空间了，结果呢你第二次回来又把人这个有用的数据给干掉了。

结果另外一个县城。就会发现莫名其妙的，你发现没有？莫名其妙的你的数据就没了。所以这是为什么说我们多线程这种bug特别难调的原因就在这里，你的线程好好的没bug，你懂吗？甚至说你的进程啊。

如果是在进程之间共享的话，你的进程没bug。没有毛病，你的程序也没有半毛钱毛病。可是很不幸的是，由于有别人家写的bug的存在，他会很容易的把你占有的这份空间给你干掉。你找谁说理去？好啦。这个叫释放多次。

产生。极其难以。极其难以调试的bug。嗯。一个县程空间。莫名其妙。被另外一个。来写过C和C加加的人，遇到过吗？遇到过的给老师扣个一。嗯。对，装装备你莫名其妙的就没了。没错。

后来呢后来啊其实谈GC呢开始聊语言的发展历史。我们我帮大家梳理一下这个语言呢，C和C加加呢它运行起来的效率非常非常的高。呃，但是呢它的开发效率很低。有的时候呢有的人呢是片面追求运行效率。但是听我说呃。

现在呢有一些大规模的软件，它并不是追求你的开并并不是追求你的你的你的运行效率有多高。也许你运行效率稍微慢一些，我拿那个硬件给你怼上去，我能接受。但是你的开发效率特别低，我就不能接受。

